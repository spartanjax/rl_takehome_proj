import os
import re
import base64
from fpdf import FPDF
from fpdf.fonts import FontFace
from fpdf.enums import XPos, YPos
from datetime import datetime, timezone
from zoneinfo import ZoneInfo
from io import BytesIO
from PIL import Image


#Embedded logo file as base64
logo_b64 = """
iVBORw0KGgoAAAANSUhEUgAAAoAAAADtCAYAAAAvOMSOAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH6AcHABssgtpwnwAALgVJREFUeNrt3Xl8XGW9P/DP95klmcyWOUmbthSsUG2hLAre6wIo/FBkqwiooMi9AkK6t3gr4HIhXjcELd0CLaKoKCrI1oogixQQBKSirC0UKNDSlmSSzJJMZzvf3x+TQlubadJmMuckn/frxYu2mcw8833O8jnPOec5AiIaKr6GcOR6KP6LpaAqKwBIQZGAQTsULwF4UUT/VfR6H+7s7EywRETDm7AEREO7zjUEwz+EyCUsBTlUEYrVEKwsFsyNXVu7XmdJiBgAiWgQWMHIXBEsAGBYDXIwBfQhCBbGU6kVpb8TEQMgEe15CAxFzxToLwHUsBrkgt3Fswr8X0c68QfWgogBkIj2QmOo/liFfTuAKKtBLtltPKQozuhIp19gLYjci6efiKqoPd31oFFzDIBNrAa5g35CYJ5uDIb/BxxEIHLvoRxLQFR90Wj0vd6i3gPg/awGuScLYmXeg68kk8kOFoOIAZCI9kAkErF8NlYC+BirQS7yiscjn347kXiFpSByD54CJnKIZDLZ4Q0GjlfBn1gNcpEDikU8FAuFDmYpiNyDI4BEzuOxQuFrBXIBS0Eu0iaiR7enUmtZCiIX7GhYAiLH0Uwu98egvwYAjmE5yCWCCjkp6PXc0pPPp1kOIgZAItoDPbnsqjp/TRzACeBoPbmAADHAHJXJZ38FoMiKEDEAEtEeyOSyT9bV+J8F5FQAXlaEXJACx9f5amsy+ez9LAaRow/YiMjpOGE0uYxC5VPx7sQDLAURAyAR7YVYKHSwgdwNyHhWg1zg5XA6eeh6YCtLQeQ8PAVM5BJbc7m3a+rqbje2ngCgkRUhh2vI+Wu3ZnLZR1gKIufhCCCRy0QiEctvY4UCR7Ia5HDJgkcmJBKJTpaCyFk4AkjkMtlsNlOfa/hd0Zc7DMJHx5Gj1YiiO5PLPsxSEDkLRwCJ3MvbEIwuh+h5LAU5WDycTo5fz2sBiRyFI4BE7mVn8tmVnDCaHK4u6699NpPLPs9SEDEAEtEg6Z0wuh2cMJocShSBTD77W1aCyEHrJUtANDxYoegZAv01gFpWgxymYPs8jZ2dnQmWgsgZDEtANDx0pBO3CuwTAHSxGuQwXk+h8AmWgcg5OAJINMzEgsFDPMZzpSofHUd9bvp9UH0PBBOG8EMXxdPJeaw9EQMgERFV0ai6+g/axm4B8JmKf5jiyXh38sOsOhEDIBEROUBjMDxfRa6q8Mck4+kkn2VN5BC8C5iIaITryeceq/PXNAL4zwp+TE3Q67muJ59Ps+JE1cebQIiICLbP820AFX1km+31voeVJmIAJCIih+js7ExA5Y6KfkhRIqw0EQMgERE5iejqyr4/wiwyEQMgERE5iELaK5svtY5VJmIAJCIip2XAyuLME0QMgERERETEAEhEREREDIBERERExABIRERERAyARERERMQASEREREQMgERERETEAEhERETEAEhEREREDIBERERExABIRERERAyARERERMQASEREREQMgERERETEAEhEREREDIBERERExABIRERERAyARERERMQASEREREQMgERERETEAEhERETEAEhEREREDIBERERExABIRERERAyARERERMQASERERESO5mUJiIbGaxMm1Bu/3xIRy2NMDMWipSIWRGKwbQsiFoCQAlEB6gAEAAAinQAA1U4BEqraJsBGGPNGUeS1lDEvTXn++RwrTEREDIBEFfD8lCn+OsCqzWYt2+OJQcRS2471hjdLVWNm259FYlC1AFgAYthuxF1tGxDp/Yu++2cAsvOHqr77x1IgLP1fFUYVUdsubJg06RWIPA3VJyDyRMLjWc1QSEREDIBE24lPnBjJ+nwxzectNaY0CifSsH2YE9Vtf471hjgLhUIQAIoez67D27ZwtlNwG4L1eBJUJwE4C6qIFgrdGyZPXqWq9/mAFWPWrn2NvU5ERAyA5Hp6zDHeLW++adkej2X3nlKFSGnkTcQyqjHdFty2D3FALAN4YdvAtiDXG9hkuzC3fbBzoSBUTxbg5AKwcMOkSf+AyB8kn//1Pq+88iaXHiIiBkCiqnp7ypRQfuvWmHo87wY427ZM7/Vx+u71caWRut7Tqhs3bQrD630nvMGUzrBK79+Vpd3e4VA9XL3e722cNOk+BX62z9ixt8uqVQWWhoiIAZBojyhgNr3//ZZtjKXFYunUqYhlesPctlG53psdSqNxqhZEYrlCwf9OkAMgvadV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f6DOX/ORYCR8R09PT4494LYQmFsT9AceBfQ0VH/CaD6KkMjheBMIkQPXSyscvVJU51dpq/B3n9onb06n29gV7hMLhQ42kLsBGe+QJnHCaCIGQCIqZyJQ0xWK/FKBM6vclFeMwQltySSv43Kh+tr693i89j0AJjujRXpbOJ06ez2wlb1DxABIRNvvtOvr6z0FvQPQTzikSZvFlpPbexL/YO+4TyQSsfw2VihwpENC4IO2z3taZ2dngr1DVH2cCJrIARrr6saagv2gg8IfAIxRow9ZwcgJ7CH3SSaTHf506Hgo/uiMFsmxJm//tSEQ2Ie9Q+SANZIlIKquhlDoQMDcg8Gd428w5URxbnt38ib2lit5rFD4GoFc6IjWKNZLacLotewaoipuGFgCouqxIpGPGJX7AIx19HZCcDrv6HQtzeRydzlowuj63gmj/5rJ5d5k9xAxABKNKA3h8KmiZiWAqAuaKwCOqfPXWJlc9l4Ayh50l55cdlWgxv+mQE5G9S//CYjKWcFAzb96stmX2TtEDIBEI4IVDp8nKjcCqHFZ0z9c5/cf3JTLregCCuxJd8nkck+XJow2pwLwVfmQwg/FmcGa2k09uSxvNCJiACQa3hrC0UtEsQSuvQlLDsr5/UfWBoN3bN26NcsedV0IXBOorXlAFKeh0k+Y2T0D4BReXkBUjWMwIhqyAy5HXYy/95uP57ToObEj07GBXes+Vig0RWDuBrCvQ5rUGk8n54ATRhMREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREbmUNIQiHS5qb06hmwXymMD+fXs6/VC1GhIOhxtrYE5TW6dCMBmKcRAEHVCjTgCbIXhKVVZE0ok/rge2VrNBVjj8UbHNZ2H0OCj2ATAagHHLQqeQz3ekE3/Y2/cZ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
"""

# Get inputted filename --> create filepath
def get_filename():
    filename = input("Please enter filename: ").strip()
    
    #Error/edgecase handling
    filename = re.sub(r'[<>:"/\\|?*]', '', filename) 
    if filename == '':
        filename = 'untitled'
        
    os.makedirs("output", exist_ok=True)
    filepath = os.path.join("output", filename+".pdf")

    # Handle same name edge case
    if os.path.exists(filepath):
        overwrite = input(f"File '{filename}' already exists. Overwrite? (y/n): ").strip().lower()
        if overwrite != "y":
            print("File not overwritten.")
            return None, None

    return filename, filepath

# Fetches the current time in UTC and NZT
def get_times():
    utc = datetime.now(timezone.utc)
    nzt = utc.astimezone(ZoneInfo("Pacific/Auckland"))
    return utc, nzt

#Creates the PDF document
def create_pdf(filename, filepath, utc, nzt):
    pdf = FPDF()
    pdf.add_page()

    # Title
    pdf.set_font("Helvetica", style="B", size=20)
    pdf.multi_cell(145, 15, f"Rocket Lab's '{filename}' Document:", align="L",new_x=XPos.LMARGIN, new_y=YPos.NEXT)

    # Time info
    pdf.set_font("Helvetica", style="B", size=12)
    pdf.cell(40, 10, "Time created:", new_x=XPos.LMARGIN)
    pdf.set_font("Helvetica", size=12)
    pdf.set_x(44)
    pdf.cell(40, 10, f"NZT: {nzt.strftime('%Y-%m-%d %H:%M:%S')}")
    pdf.set_x(97)
    pdf.cell(40, 10, f"| UTC: {utc.strftime('%Y-%m-%d %H:%M:%S')}")

    # Logo
    logo_file = BytesIO(base64.b64decode(logo_b64))
    img = Image.open(logo_file)
    image_final = BytesIO()
    img.save(image_final, format='PNG')
    image_final.seek(0)
    pdf.image(image_final, x=160, y=16, w=40) 

    # Horizontal line
    pdf.line(10, pdf.get_y()+10, 200, pdf.get_y()+10)

    # Greeting text
    pdf.set_font("Helvetica", style="I", size=12)
    pdf.ln(10)
    pdf.cell(0, 10, "Hello from Jackson Fontaine! *insert file information here*", new_x=XPos.LMARGIN, new_y=YPos.NEXT)

    # Save file
    pdf.output(filepath)
    
def main():
    # try:
    filename, filepath = get_filename()
    if not filename:
        return
    utc, nzt = get_times()
    create_pdf(filename, filepath, utc, nzt)
    print(f"PDF generated: {filepath}")

    # except Exception as e:
        # print("An error occurred while generating PDF. Please try again.")
        # print(e)

if __name__ == "__main__":
    main()
